<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PantryChef Pro - 忙しいママのための簡単レシピ</title>
  <link rel="manifest" href="manifest.json">
  <meta name="description" content="忙しい共働きママの味方！冷蔵庫の食材から時短レシピを提案。食材ロス削減で節約も♪">
  <meta property="og:title" content="PantryChef Pro - 忙しいママのレシピアプリ">
  <meta property="og:description" content="冷蔵庫の残り物で何作ろう？AIが15分以内の時短レシピを提案！">
  <meta property="og:image" content="images/ogp-image.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/3WuuKQAAAAASUVORK5CYII=">
  
  <!-- External Libraries -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --primary-color: #4CAF50;
      --primary-dark: #388E3C;
      --secondary-color: #FF9800;
      --accent-color: #2196F3;
      --warm-pink: #FFE0E6;
      --soft-green: #E8F5E8;
      --light-orange: #FFF3E0;
      --background: #FAFAFA;
      --surface: #FFFFFF;
      --text-primary: #2E2E2E;
      --text-secondary: #666666;
      --border: #E0E0E0;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
      --shadow-hover: 0 8px 25px rgba(0,0,0,0.12);
      --radius: 16px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--background);
      color: var(--text-primary);
      line-height: 1.7;
      font-weight: 400;
    }

    .mama-header {
      background: linear-gradient(135deg, var(--primary-color) 0%, #66BB6A 100%);
      color: white;
      padding: 3rem 0 4rem;
      position: relative;
      overflow: hidden;
    }

    .mama-header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -10%;
      width: 300px;
      height: 300px;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
      transform: rotate(45deg);
    }

    .mama-header::after {
      content: '';
      position: absolute;
      bottom: -30%;
      left: -5%;
      width: 200px;
      height: 200px;
      background: rgba(255,255,255,0.05);
      border-radius: 50%;
    }

    .header-content {
      position: relative;
      z-index: 2;
      text-align: center;
    }

    .app-logo {
      font-size: 3.5rem;
      margin-bottom: 1rem;
      display: block;
    }

    .app-title {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 1rem;
      letter-spacing: -0.02em;
    }

    .app-subtitle {
      font-size: 1.2rem;
      opacity: 0.95;
      margin-bottom: 2rem;
      font-weight: 300;
    }

    .mama-benefits {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
      margin-top: 2rem;
    }

    .benefit-item {
      background: rgba(255,255,255,0.15);
      padding: 1rem 1.5rem;
      border-radius: 25px;
      font-size: 0.9rem;
      font-weight: 500;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
    }

    .main-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1.5rem;
      position: relative;
      margin-top: -2rem;
    }

    .quick-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .stat-card {
      background: var(--surface);
      padding: 2rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      text-align: center;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
    }

    .stat-icon {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      color: var(--primary-color);
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }

    .stat-label {
      font-size: 1rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    .mama-section {
      background: var(--surface);
      border-radius: var(--radius);
      padding: 2.5rem;
      margin-bottom: 2.5rem;
      box-shadow: var(--shadow);
      position: relative;
    }

    .section-header {
      display: flex;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 3px solid #f0f0f0;
    }
      .section-header.accordion-header {
        cursor: pointer;
        position: relative;
      }

    .section-icon {
      font-size: 2rem;
      margin-right: 1rem;
      padding: 1rem;
      background: var(--soft-green);
      border-radius: 50%;
      color: var(--primary-color);
    }

    .section-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0;
    }

    .section-subtitle {
      font-size: 1rem;
      color: var(--text-secondary);
      margin-top: 0.5rem;
      font-weight: 400;
    }

    .ingredients-container {
      background: var(--soft-green);
      padding: 2rem;
      border-radius: var(--radius);
      margin-bottom: 2rem;
    }

    .ingredients-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 1rem;
    }

    .ingredient-card {
      background: var(--surface);
      border: 2px solid transparent;
      border-radius: 12px;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      position: relative;
      user-select: none;
    }

    .ingredient-card:hover {
      border-color: var(--primary-color);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.2);
    }

    .ingredient-card.selected {
      border-color: var(--primary-color);
      background: linear-gradient(135deg, var(--soft-green), rgba(76, 175, 80, 0.1));
      transform: translateY(-2px);
    }

    .ingredient-card .ingredient-emoji {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      display: block;
    }

    .ingredient-card .ingredient-name {
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--text-primary);
    }

    .ingredient-card input[type="checkbox"] {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      width: 20px;
      height: 20px;
      accent-color: var(--primary-color);
    }

    .custom-ingredient-section {
      background: var(--light-orange);
      padding: 2rem;
      border-radius: var(--radius);
      margin-top: 2rem;
    }

    .custom-ingredient-header {
      display: flex;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .custom-ingredient-icon {
      font-size: 1.5rem;
      margin-right: 0.5rem;
      color: var(--secondary-color);
    }

    .custom-ingredient-input {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .custom-ingredient-field {
      flex: 1;
      padding: 1rem;
      border: 2px solid var(--border);
      border-radius: 12px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }

    .custom-ingredient-field:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.1);
    }

    .mama-button {
      padding: 1rem 2rem;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-family: inherit;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
    }

    .btn-secondary {
      background: linear-gradient(135deg, var(--secondary-color), #F57C00);
      color: white;
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 152, 0, 0.3);
    }

    .filters-section {
      background: var(--warm-pink);
      padding: 2rem;
      border-radius: var(--radius);
      margin-bottom: 2rem;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
    }

    .filter-label {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .filter-control {
      padding: 1rem;
      border: 2px solid var(--border);
      border-radius: 12px;
      font-size: 1rem;
      background: var(--surface);
      transition: border-color 0.3s ease;
    }

    .filter-control:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
    }

    .search-section {
      text-align: center;
      padding: 3rem 2rem;
    }

    .fixed-search {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      padding: 0;
    }

    .search-btn {
      font-size: 1.3rem;
      padding: 1.5rem 4rem;
      background: linear-gradient(135deg, var(--accent-color), #1976D2);
      border: none;
      border-radius: 50px;
      color: white;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }

    .search-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(33, 150, 243, 0.4);
    }

    .search-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .search-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255,255,255,0.2);
      border-radius: 50%;
      transition: all 0.6s ease;
      transform: translate(-50%, -50%);
    }

    .search-btn:active::before {
      width: 300px;
      height: 300px;
    }

    .results-container {
      margin-top: 3rem;
    }

    .recipe-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
      gap: 2rem;
    }

    .recipe-card {
      background: var(--surface);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      position: relative;
      border: 2px solid transparent;
    }

    .recipe-card:hover {
      transform: translateY(-6px);
      box-shadow: var(--shadow-hover);
      border-color: var(--primary-color);
    }

    .recipe-header {
      padding: 2rem;
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: white;
      position: relative;
      cursor: pointer;
    }

    .accordion-arrow {
      position: absolute;
      top: 50%;
      right: 1.5rem;
      transform: translateY(-50%);
    }

    .accordion-content {
      display: none;
    }

    .recipe-badges {
      position: absolute;
      top: 1rem;
      right: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .recipe-badge {
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      text-align: center;
      backdrop-filter: blur(10px);
    }

    .match-badge {
      background: var(--secondary-color);
      color: white;
    }

    .time-badge {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
    }

    .recipe-title {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      line-height: 1.3;
    }

    .recipe-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.95rem;
      opacity: 0.95;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .recipe-content {
      padding: 2rem;
    }

    .ingredients-section {
      margin-bottom: 2rem;
    }

    .ingredients-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .ingredients-list {
      list-style: none;
      background: var(--background);
      border-radius: 12px;
      padding: 1rem;
    }

    .ingredient-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--border);
    }

    .ingredient-item:last-child {
      border-bottom: none;
    }

    .ingredient-available {
      color: var(--primary-color);
      font-weight: 600;
    }

    .ingredient-missing {
      color: var(--text-secondary);
    }

    .instructions-section {
      background: var(--background);
      padding: 1.5rem;
      border-radius: 12px;
      margin-bottom: 2rem;
    }

    .instructions-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .instructions-list {
      list-style: none;
      counter-reset: step-counter;
    }

    .instructions-list li {
      counter-increment: step-counter;
      margin-bottom: 1rem;
      padding-left: 3rem;
      position: relative;
      line-height: 1.6;
    }

    .instructions-list li::before {
      content: counter(step-counter);
      position: absolute;
      left: 0;
      top: 0;
      background: var(--primary-color);
      color: white;
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .nutrition-section {
      background: var(--soft-green);
      padding: 1.5rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
    }

    .nutrition-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 1rem;
    }

    .nutrition-item {
      text-align: center;
      background: var(--surface);
      padding: 1rem;
      border-radius: 8px;
    }

    .nutrition-value {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--primary-color);
    }

    .nutrition-label {
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-top: 0.3rem;
    }

    .recipe-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .recipe-tag {
      background: var(--warm-pink);
      color: var(--text-primary);
      padding: 0.4rem 1rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }

    .mama-tips {
      background: linear-gradient(135deg, #FFF9C4, #FFF3E0);
      padding: 2rem;
      border-radius: var(--radius);
      margin: 3rem 0;
      border-left: 6px solid var(--secondary-color);
    }

    .tips-header {
      display: flex;
      align-items: center;
      margin-bottom: 1rem;
    }

    .tips-icon {
      font-size: 2rem;
      margin-right: 1rem;
      color: var(--secondary-color);
    }

    .tips-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .tips-list {
      list-style: none;
      padding: 0;
    }

    .tips-list li {
      padding: 0.75rem 0;
      display: flex;
      align-items: flex-start;
      gap: 1rem;
    }

    .tips-list li::before {
      content: '💡';
      font-size: 1.2rem;
      flex-shrink: 0;
    }

    .loading-state {
      text-align: center;
      padding: 4rem 2rem;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid var(--border);
      border-top: 4px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 2rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .no-results {
      text-align: center;
      padding: 4rem 2rem;
      color: var(--text-secondary);
    }

    .no-results-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .footer {
      background: var(--text-primary);
      color: white;
      text-align: center;
      padding: 3rem 0;
      margin-top: 4rem;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    .footer-links a {
      color: white;
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      transition: background-color 0.3s ease;
    }

    .footer-links a:hover {
      background-color: rgba(255,255,255,0.1);
    }

    .difficulty-easy {
      background: var(--soft-green);
      color: var(--primary-dark);
    }

    .difficulty-medium {
      background: var(--light-orange);
      color: #F57C00;
    }

    .difficulty-hard {
      background: var(--warm-pink);
      color: #C62828;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .main-container {
        padding: 0 1rem;
      }
      
      .app-title {
        font-size: 1.8rem;
      }
      
      .mama-benefits {
        gap: 1rem;
      }
      
      .benefit-item {
        padding: 0.75rem 1rem;
        font-size: 0.8rem;
      }

      .ingredients-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 0.75rem;
      }

      .quick-stats {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 1rem;
      }

      .stat-card {
        padding: 1rem;
      }

      .stat-icon {
        font-size: 2rem;
      }

      .stat-value {
        font-size: 2rem;
      }
      
      .recipe-grid {
        grid-template-columns: 1fr;
      }
      
      .filters-grid {
        grid-template-columns: 1fr;
      }
      
      .mama-section {
        padding: 1.5rem;
      }

      .search-btn {
        padding: 1.2rem 2.5rem;
        font-size: 1.1rem;
      }

      .custom-ingredient-input {
        flex-direction: column;
      }

      .custom-ingredient-input .mama-button {
        width: 100%;
      }

      .custom-ingredient-input .custom-ingredient-field {
        width: 100%;
      }
    }

    /* PDF Export Optimization */
    @media print {
      * {
        box-shadow: none !important;
      }
      
      .mama-header::before,
      .mama-header::after {
        display: none;
      }
      
      body {
        background: white;
      }
      
      .mama-section,
      .stat-card {
        break-inside: avoid;
        page-break-inside: avoid;
      }
    }
  </style>
</head>
<body>
  <header class="mama-header">
    <div class="main-container">
      <div class="header-content">
        <span class="app-logo">👩‍🍳✨</span>
        <h1 class="app-title">PantryChef Pro</h1>
        <p class="app-subtitle">忙しいママの味方！冷蔵庫の食材から時短レシピを提案</p>
        <div class="mama-benefits">
          <div class="benefit-item">
            <i class="fas fa-clock"></i> 15分以内の時短レシピ
          </div>
          <div class="benefit-item">
            <i class="fas fa-leaf"></i> 食材ロス削減で節約
          </div>
          <div class="benefit-item">
            <i class="fas fa-heart"></i> 栄養バランス重視
          </div>
          <div class="benefit-item">
            <i class="fas fa-mobile-alt"></i> スマホで簡単操作
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="main-container">
      <!-- Quick Stats Section -->
      <div class="quick-stats" id="stats">
        <div class="stat-card">
          <div class="stat-icon">🥬</div>
          <div class="stat-value" id="selected-count">0</div>
          <div class="stat-label">選択した食材</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">📱</div>
          <div class="stat-value" id="recipe-count">0</div>
          <div class="stat-label">見つかったレシピ</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">🍳</div>
          <div class="stat-value" id="total-recipe-count">0</div>
          <div class="stat-label">総レシピ数</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">⭐</div>
          <div class="stat-value" id="match-rate">0%</div>
          <div class="stat-label">平均マッチ率</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">⏱️</div>
          <div class="stat-value" id="avg-time">0分</div>
          <div class="stat-label">平均調理時間</div>
        </div>
      </div>

      <!-- Ingredients Selection Section -->
      <section class="mama-section">
        <div class="section-header accordion-header" onclick="toggleSection(event)">
          <div class="section-icon">
            <i class="fas fa-carrot"></i>
          </div>
          <div>
            <h2 class="section-title">冷蔵庫の食材をチェック</h2>
            <p class="section-subtitle">今ある食材を選んで、無駄なく美味しく！</p>
          </div>
            <span class="accordion-arrow"><i class="fas fa-chevron-down"></i></span>
        </div>

        <div class="accordion-content">
          <div class="ingredients-container">
            <div class="ingredients-grid" id="ingredients"></div>
          </div>

          <div class="custom-ingredient-section">
            <div class="custom-ingredient-header">
              <i class="fas fa-plus-circle custom-ingredient-icon"></i>
              <h3>その他の食材を追加</h3>
            </div>
            <div class="custom-ingredient-input">
              <input type="text" id="custom-ingredient" class="custom-ingredient-field" placeholder="例：きゅうり、しいたけ、豆腐...">
              <button class="mama-button btn-secondary" id="add-ingredient">
                <i class="fas fa-plus"></i> 追加
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Search Filters Section -->
      <section class="mama-section">
        <div class="section-header accordion-header" onclick="toggleSection(event)">
          <div class="section-icon">
            <i class="fas fa-filter"></i>
          </div>
          <div>
            <h2 class="section-title">お好みの条件を設定</h2>
            <p class="section-subtitle">忙しい日でも安心！時短レシピを優先検索</p>
          </div>
          <span class="accordion-arrow"><i class="fas fa-chevron-down"></i></span>
        </div>

        <div class="accordion-content">
          <div class="filters-section">
            <div class="filters-grid">
            <div class="filter-group">
              <label class="filter-label">
                <i class="fas fa-clock"></i> 調理時間（重要！）
              </label>
              <select id="time-filter" class="filter-control">
                <option value="">指定なし</option>
                <option value="15" selected>15分以内（おすすめ）</option>
                <option value="30">30分以内</option>
                <option value="60">60分以内</option>
              </select>
            </div>
            <div class="filter-group">
              <label class="filter-label">
                <i class="fas fa-star"></i> 難易度
              </label>
              <select id="difficulty-filter" class="filter-control">
                <option value="">指定なし</option>
                <option value="easy" selected>簡単（おすすめ）</option>
                <option value="medium">普通</option>
                <option value="hard">本格的</option>
              </select>
            </div>
            <div class="filter-group">
              <label class="filter-label">
                <i class="fas fa-utensils"></i> 料理カテゴリ
              </label>
              <select id="category-filter" class="filter-control">
                <option value="">指定なし</option>
                <option value="main">メイン料理</option>
                <option value="side">副菜・おかず</option>
                <option value="soup">スープ・汁物</option>
                <option value="dessert">デザート</option>
              </select>
            </div>
            <div class="filter-group">
              <label class="filter-label">
                <i class="fas fa-heart"></i> カロリー上限
              </label>
              <input type="number" id="calorie-filter" class="filter-control" placeholder="例: 400" min="0" max="1000" step="50">
            </div>
          </div>
        </div>
        
        </div>
      </section>

      <!-- Mama Tips Section -->
      <div class="mama-tips">
        <div class="tips-header">
          <div class="tips-icon">💝</div>
          <h3 class="tips-title">忙しいママのための時短テクニック</h3>
        </div>
        <ul class="tips-list">
          <li>週末に野菜をカットして冷凍保存すると平日が楽になります</li>
          <li>一度に多めに作って翌日のお弁当のおかずにも活用しましょう</li>
          <li>調味料は計量スプーンを使わず、小さじ1＝ペットボトルキャップ1杯で代用OK</li>
          <li>子どもが好きな味付けのレシピは★マークでお気に入り登録を！</li>
        </ul>
      </div>

      <!-- Results Section -->
      <section id="results-section" style="display: none;">
        <div class="mama-section">
          <div class="section-header">
            <div class="section-icon">
              <i class="fas fa-list-ul"></i>
            </div>
            <div>
              <h2 class="section-title">おすすめレシピ</h2>
              <p class="section-subtitle">あなたにぴったりのレシピが見つかりました！</p>
            </div>
          </div>
          <div id="results"></div>
        </div>
      </section>
    </div>
  </main>

  <div class="search-section fixed-search">
    <button class="search-btn" id="search">
      <i class="fas fa-magic"></i> AIにレシピを提案してもらう
    </button>
  </div>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-links">
        <a href="#privacy"><i class="fas fa-shield-alt"></i> プライバシーポリシー</a>
        <a href="#terms"><i class="fas fa-file-contract"></i> 利用規約</a>
        <a href="#contact"><i class="fas fa-envelope"></i> お問い合わせ</a>
        <a href="#feedback"><i class="fas fa-comment-dots"></i> ご意見・ご要望</a>
      </div>
      <p style="opacity: 0.8; margin-top: 1rem;">
        <i class="fas fa-heart" style="color: #FF6B9D;"></i> 
        忙しいママを応援する PantryChef Pro © 2024
      </p>
    </div>
  </footer>

<script>
// Enhanced Recipe Data with more family-friendly recipes
const mamaRecipesData = {
  ingredients: [
    { name: '卵', emoji: '🥚' },
    { name: '牛乳', emoji: '🥛' },
    { name: '鶏肉', emoji: '🐔' },
    { name: '豚肉', emoji: '🐷' },
    { name: '牛肉', emoji: '🐄' },
    { name: '玉ねぎ', emoji: '🧅' },
    { name: 'トマト', emoji: '🍅' },
    { name: 'じゃがいも', emoji: '🥔' },
    { name: 'にんじん', emoji: '🥕' },
    { name: 'キャベツ', emoji: '🥬' },
    { name: 'ブロッコリー', emoji: '🥦' },
    { name: 'ほうれん草', emoji: '🥬' },
    { name: 'レタス', emoji: '🥬' },
    { name: '白菜', emoji: '🥬' },
    { name: 'もやし', emoji: '🌱' },
    { name: 'きのこ類', emoji: '🍄' },
    { name: 'にんにく', emoji: '🧄' },
    { name: '生姜', emoji: '🫚' },
    { name: 'ご飯', emoji: '🍚' },
    { name: 'パン', emoji: '🍞' },
    { name: 'パスタ', emoji: '🍝' },
    { name: 'うどん', emoji: '🍜' },
    { name: 'そば', emoji: '🍜' },
    { name: 'チーズ', emoji: '🧀' },
    { name: '小麦粉', emoji: '🌾' },
    { name: '片栗粉', emoji: '🌾' },
    { name: 'ピーマン', emoji: '🫑' },
    { name: 'ズッキーニ', emoji: '🥒' },
    { name: 'ナス', emoji: '🍆' },
    { name: '鮭', emoji: '🐟' },
    { name: '豆腐', emoji: '🍢' }
  ],
  recipes: [
    {
      id: 1,
      name: '忙しいママの簡単オムライス',
      ingredients: ['卵', 'ご飯', '玉ねぎ', 'ケチャップ', 'バター', '塩', 'こしょう'],
      cookingTime: 12,
      difficulty: 'easy',
      category: 'main',
      calories: 380,
      servings: 2,
      instructions: [
        'フライパンにバターを溶かし、みじん切りした玉ねぎを炒める',
        'ご飯を加えてケチャップで炒めてチキンライスを作る',
        '卵を溶いて別のフライパンで薄焼きにする',
        'チキンライスを卵で包んで完成！'
      ],
      nutrition: { protein: 15, carbs: 45, fat: 18, fiber: 2 },
      tags: ['子ども大好き', '時短', '定番', 'お弁当にも'],
      mamaNote: '冷凍ご飯を使えばさらに時短！子どもも喜ぶ定番メニューです。'
    },
    {
      id: 2,
      name: '栄養満点！野菜たっぷりハンバーグ',
      ingredients: ['豚肉', '玉ねぎ', 'にんじん', 'キャベツ', '卵', 'パン', '牛乳', '塩', 'こしょう'],
      cookingTime: 18,
      difficulty: 'easy',
      category: 'main',
      calories: 320,
      servings: 3,
      instructions: [
        '野菜をみじん切りにしてレンジで2分加熱',
        'パンを牛乳に浸してふやかす',
        '豚肉、野菜、パン、卵を混ぜて成形',
        'フライパンで両面焼いて蒸し焼きにする'
      ],
      nutrition: { protein: 22, carbs: 15, fat: 16, fiber: 3 },
      tags: ['野菜たっぷり', '栄養満点', '冷凍OK', '子ども向け'],
      mamaNote: '野菜嫌いの子どもでも食べやすい！まとめて作って冷凍保存もできます。'
    },
    {
      id: 3,
      name: '包丁いらず！もやし豚巻き',
      ingredients: ['豚肉', 'もやし', '醤油', 'みりん', '酒', '砂糖', '油'],
      cookingTime: 10,
      difficulty: 'easy',
      category: 'main',
      calories: 280,
      servings: 2,
      instructions: [
        'もやしを豚肉で巻く（包丁不要！）',
        'フライパンに油を熱して巻き終わりを下にして焼く',
        '全体に焼き色がついたら調味料を加える',
        '汁気がなくなるまで絡めて完成'
      ],
      nutrition: { protein: 25, carbs: 8, fat: 15, fiber: 2 },
      tags: ['包丁不要', '超時短', 'ヘルシー', '節約'],
      mamaNote: '洗い物が少なくて済む忙しい日の救世主レシピ！'
    },
    {
      id: 4,
      name: 'レンジで簡単！蒸し鶏サラダ',
      ingredients: ['鶏肉', 'キャベツ', 'にんじん', '醤油', '酢', '砂糖', 'ごま油', '塩'],
      cookingTime: 8,
      difficulty: 'easy',
      category: 'main',
      calories: 220,
      servings: 2,
      instructions: [
        '鶏肉に塩をして耐熱皿にのせラップをしてレンジで5分',
        'キャベツとにんじんを千切りにして水にさらす',
        '鶏肉を手で裂いて野菜と混ぜる',
        'ドレッシングの材料を混ぜてかける'
      ],
      nutrition: { protein: 28, carbs: 6, fat: 8, fiber: 3 },
      tags: ['レンジ調理', 'ヘルシー', '火を使わない', 'ダイエット'],
      mamaNote: '火を使わないので夏場にも安心！ヘルシーで栄養バランス◎'
    },
    {
      id: 5,
      name: 'ワンポット！トマトスープパスタ',
      ingredients: ['パスタ', 'トマト', '玉ねぎ', 'にんにく', 'ベーコン', 'チーズ', '牛乳', '塩', 'こしょう'],
      cookingTime: 15,
      difficulty: 'easy',
      category: 'main',
      calories: 420,
      servings: 2,
      instructions: [
        '深いフライパンに材料をすべて入れる',
        '水を加えて強火で沸騰させる',
        'パスタが柔らかくなるまで煮込む',
        'チーズを加えて混ぜ合わせる'
      ],
      nutrition: { protein: 18, carbs: 52, fat: 16, fiber: 4 },
      tags: ['ワンポット', '洗い物少', '子ども好み', '簡単'],
      mamaNote: 'お鍋ひとつで完成！洗い物が少なくて忙しい日にぴったり。'
    },
    {
      id: 6,
      name: '5分で完成！卵とじうどん',
      ingredients: ['うどん', '卵', '玉ねぎ', '醤油', 'みりん', '砂糖', 'だしの素'],
      cookingTime: 5,
      difficulty: 'easy',
      category: 'main',
      calories: 320,
      servings: 1,
      instructions: [
        '冷凍うどんをレンジで温める',
        'フライパンに調味料とだし、玉ねぎを入れて煮る',
        'うどんを加えて溶き卵を回し入れる',
        '卵が半熟になったら完成'
      ],
      nutrition: { protein: 15, carbs: 48, fat: 8, fiber: 2 },
      tags: ['超時短', '朝食にも', '夜食にも', '優しい味'],
      mamaNote: '体調悪い日や忙しい朝にも◎優しい味で家族みんなに好評です。'
    },
    {
      id: 7,
      name: 'カット野菜で時短！野菜炒め',
      ingredients: ['カット野菜', '豚肉', '醤油', 'みりん', '油', '塩', 'こしょう'],
      cookingTime: 7,
      difficulty: 'easy',
      category: 'side',
      calories: 180,
      servings: 2,
      instructions: [
        'フライパンに油を熱して豚肉を炒める',
        'カット野菜を加えて強火で炒める',
        '調味料を加えて全体に絡める',
        '塩こしょうで味を調える'
      ],
      nutrition: { protein: 12, carbs: 8, fat: 10, fiber: 4 },
      tags: ['カット野菜', 'コンビニ食材', '超時短', '野菜不足解消'],
      mamaNote: 'コンビニのカット野菜を活用！切る手間なしで野菜不足解消。'
    },
    {
      id: 8,
      name: 'レンジで簡単！肉じゃが',
      ingredients: ['じゃがいも', '玉ねぎ', 'にんじん', '豚肉', '醤油', 'みりん', '砂糖', 'だしの素'],
      cookingTime: 12,
      difficulty: 'easy',
      category: 'main',
      calories: 280,
      servings: 3,
      instructions: [
        'じゃがいも、にんじんを一口大に切ってレンジで3分',
        '耐熱ボウルに全ての材料を入れる',
        'ラップをしてレンジで8分加熱',
        '一度混ぜてさらに2分加熱'
      ],
      nutrition: { protein: 18, carbs: 32, fat: 8, fiber: 3 },
      tags: ['レンジ調理', '定番おかず', '火を使わない', '作り置きOK'],
      mamaNote: 'コンロを使わないので他の料理と同時進行できて便利！'
    },
    {
      id: 9,
      name: 'ピーマンと豚肉のみそ炒め',
      ingredients: ['豚肉', 'ピーマン', 'にんじん', 'みそ', 'みりん', '砂糖', '油'],
      cookingTime: 10,
      difficulty: 'easy',
      category: 'main',
      calories: 310,
      servings: 2,
      instructions: [
        'フライパンで豚肉とピーマンを炒める',
        'にんじんを加えてさらに炒める',
        '調味料を加えて全体を絡める',
        '水分が飛んだら完成'
      ],
      nutrition: { protein: 20, carbs: 14, fat: 18, fiber: 3 },
      tags: ['ご飯が進む', '時短', '野菜追加'],
      mamaNote: '味噌だれでご飯が進む！冷蔵庫の残り野菜でアレンジ自在。'
    },
    {
      id: 10,
      name: '鮭のバター醤油ソテー',
      ingredients: ['鮭', 'バター', '醤油', '塩', 'こしょう'],
      cookingTime: 10,
      difficulty: 'easy',
      category: 'main',
      calories: 260,
      servings: 2,
      instructions: [
        'フライパンにバターを溶かして鮭を焼く',
        '両面に焼き色がついたら醤油を回し入れる',
        '塩こしょうで味を整えて完成',
        'お好みでレモンを添える'
      ],
      nutrition: { protein: 22, carbs: 4, fat: 16, fiber: 0 },
      tags: ['フライパン', '魚料理', '子ども喜ぶ'],
      mamaNote: '冷凍鮭を使えば解凍して焼くだけ！忙しい夕食に◎'
    },
    {
      id: 11,
      name: '豆腐とナスのそぼろあん',
      ingredients: ['豆腐', 'ナス', '鶏肉', '醤油', 'みりん', '砂糖', '片栗粉', '油'],
      cookingTime: 15,
      difficulty: 'easy',
      category: 'side',
      calories: 210,
      servings: 2,
      instructions: [
        'ナスを炒めて取り出す',
        '鶏肉を炒めて調味料を加える',
        '水溶き片栗粉でとろみをつける',
        'ナスと豆腐を加えてさっと絡める'
      ],
      nutrition: { protein: 14, carbs: 10, fat: 12, fiber: 2 },
      tags: ['ヘルシー', 'ご飯に合う', '作り置き'],
      mamaNote: 'とろみのあるあんが子どもに人気。豆腐でヘルシー！'
    }
  ]
};

// Application State
let selectedIngredients = new Set();
let currentRecipes = [];
let favorites = new Set();

// DOM Elements
const ingredientsDiv = document.getElementById('ingredients');
const customInput = document.getElementById('custom-ingredient');
const addBtn = document.getElementById('add-ingredient');
const searchBtn = document.getElementById('search');
const resultsDiv = document.getElementById('results');
const resultsSection = document.getElementById('results-section');
const timeFilter = document.getElementById('time-filter');
const difficultyFilter = document.getElementById('difficulty-filter');
const categoryFilter = document.getElementById('category-filter');
const calorieFilter = document.getElementById('calorie-filter');

// Stats elements
const selectedCountEl = document.getElementById('selected-count');
const recipeCountEl = document.getElementById('recipe-count');
const totalRecipeCountEl = document.getElementById('total-recipe-count');
const matchRateEl = document.getElementById('match-rate');
const avgTimeEl = document.getElementById('avg-time');

// Initialize the app
function init() {
  renderIngredients();
  loadFavorites();
  updateStats();
  
  // Set default filters for busy moms
  timeFilter.value = '15';
  difficultyFilter.value = 'easy';
}

// Render ingredient cards with emojis
function renderIngredients() {
  ingredientsDiv.innerHTML = '';
  mamaRecipesData.ingredients.forEach(ingredient => {
    const card = document.createElement('div');
    card.className = 'ingredient-card';
    
    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.value = ingredient.name;
    checkbox.id = `ingredient-${ingredient.name}`;
    
    card.innerHTML = `
      <span class="ingredient-emoji">${ingredient.emoji}</span>
      <span class="ingredient-name">${ingredient.name}</span>
    `;
    card.appendChild(checkbox);
    
    // Event listeners
    card.addEventListener('click', (e) => {
      if (e.target.type !== 'checkbox') {
        checkbox.checked = !checkbox.checked;
      }
      toggleIngredient(ingredient.name, checkbox.checked);
      card.classList.toggle('selected', checkbox.checked);
    });
    
    checkbox.addEventListener('change', (e) => {
      toggleIngredient(ingredient.name, e.target.checked);
      card.classList.toggle('selected', e.target.checked);
    });
    
    ingredientsDiv.appendChild(card);
  });
}

// Toggle ingredient selection
function toggleIngredient(ingredient, isSelected) {
  if (isSelected) {
    selectedIngredients.add(ingredient);
  } else {
    selectedIngredients.delete(ingredient);
  }
  updateStats();
}

// Add custom ingredient
function addCustomIngredient() {
  const ingredient = customInput.value.trim();
  if (!ingredient) return;
  
  if (selectedIngredients.has(ingredient)) {
    showNotification('この食材は既に選択されています', 'warning');
    return;
  }
  
  selectedIngredients.add(ingredient);
  
  // Add to UI
  const card = document.createElement('div');
  card.className = 'ingredient-card selected';
  card.innerHTML = `
    <span class="ingredient-emoji">🥘</span>
    <span class="ingredient-name">${ingredient}</span>
    <input type="checkbox" checked>
  `;
  
  card.addEventListener('click', () => {
    selectedIngredients.delete(ingredient);
    card.remove();
    updateStats();
  });
  
  ingredientsDiv.appendChild(card);
  customInput.value = '';
  updateStats();
  showNotification('食材を追加しました！', 'success');
}

// Calculate recipe match score
function calculateMatchScore(recipe) {
  const availableIngredients = recipe.ingredients.filter(ing => 
    selectedIngredients.has(ing)
  );
  return availableIngredients.length / recipe.ingredients.length;
}

// Filter and search recipes
function searchRecipes() {
  if (selectedIngredients.size === 0) {
    showNotification('食材を選択してください', 'warning');
    return;
  }
  
  const maxTime = parseInt(timeFilter.value) || Infinity;
  const difficulty = difficultyFilter.value;
  const category = categoryFilter.value;
  const maxCalories = parseInt(calorieFilter.value) || Infinity;
  
  // Show loading
  showLoading();
  
  setTimeout(() => {
    currentRecipes = mamaRecipesData.recipes
      .filter(recipe => {
        return recipe.cookingTime <= maxTime &&
               (!difficulty || recipe.difficulty === difficulty) &&
               (!category || recipe.category === category) &&
               recipe.calories <= maxCalories;
      })
      .map(recipe => ({
        recipe,
        score: calculateMatchScore(recipe)
      }))
      .filter(item => item.score > 0)
      .sort((a, b) => b.score - a.score)
      .slice(0, 12);
    
    renderResults();
    updateStats();
    showNotification(`${currentRecipes.length}件のレシピが見つかりました！`, 'success');
  }, 1200);
}

// Show loading state with mama-friendly messages
function showLoading() {
  resultsDiv.innerHTML = `
    <div class="loading-state">
      <div class="loading-spinner"></div>
      <h3>あなたにぴったりのレシピを探しています...</h3>
      <p style="color: var(--text-secondary); margin-top: 1rem;">
        🔍 時短レシピを優先的に検索中<br>
        💝 栄養バランスも考慮しています<br>
        👨‍👩‍👧‍👦 家族みんなが喜ぶメニューを厳選中
      </p>
    </div>
  `;
  resultsSection.style.display = 'block';
  resultsSection.scrollIntoView({ behavior: 'smooth' });
}

// Render search results
function renderResults() {
  if (currentRecipes.length === 0) {
    resultsDiv.innerHTML = `
      <div class="no-results">
        <div class="no-results-icon">😔</div>
        <h3>条件に合うレシピが見つかりませんでした</h3>
        <p>検索条件を緩めて再度お試しください</p>
        <p style="margin-top: 1rem; color: var(--text-secondary);">
          💡 ヒント：調理時間を長めに設定したり、食材を追加してみてください
        </p>
      </div>
    `;
    return;
  }
  
  resultsDiv.innerHTML = `
    <div class="recipe-grid">
      ${currentRecipes.map(item => renderRecipeCard(item.recipe, item.score)).join('')}
    </div>
  `;
}

// Render individual recipe card
function renderRecipeCard(recipe, score) {
  const matchPercentage = Math.round(score * 100);
  const isFavorited = favorites.has(recipe.id);

  return `
    <div class="recipe-card">
      <div class="recipe-header accordion-header" onclick="toggleRecipeDetails(event)">
        <div class="recipe-badges">
          <div class="recipe-badge match-badge">${matchPercentage}% マッチ</div>
          <div class="recipe-badge time-badge">⏱️ ${recipe.cookingTime}分</div>
        </div>

      <div class="recipe-title">${recipe.name}</div>
      <div class="recipe-meta">
        <span><i class="fas fa-users"></i> ${recipe.servings}人分</span>
        <span class="difficulty-badge difficulty-${recipe.difficulty}">
          ${getDifficultyText(recipe.difficulty)}
        </span>
        <span><i class="fas fa-fire"></i> ${recipe.calories}kcal</span>
      </div>
      <span class="accordion-arrow"><i class="fas fa-chevron-down"></i></span>
    </div>
      <div class="recipe-content accordion-content">
        <div class="ingredients-section">
          <h4 class="ingredients-title">
            <i class="fas fa-list"></i> 材料 (${recipe.ingredients.length}種類)
          </h4>
          <ul class="ingredients-list">
            ${recipe.ingredients.map(ingredient => `
              <li class="ingredient-item">
                <span class="${selectedIngredients.has(ingredient) ? 'ingredient-available' : 'ingredient-missing'}">
                  ${selectedIngredients.has(ingredient) ? '✅' : '❌'} ${ingredient}
                </span>
              </li>
            `).join('')}
          </ul>
        </div>
        
        <div class="nutrition-section">
          <div class="nutrition-grid">
            <div class="nutrition-item">
              <div class="nutrition-value">${recipe.calories}</div>
              <div class="nutrition-label">カロリー</div>
            </div>
            <div class="nutrition-item">
              <div class="nutrition-value">${recipe.nutrition.protein}g</div>
              <div class="nutrition-label">たんぱく質</div>
            </div>
            <div class="nutrition-item">
              <div class="nutrition-value">${recipe.nutrition.carbs}g</div>
              <div class="nutrition-label">炭水化物</div>
            </div>
            <div class="nutrition-item">
              <div class="nutrition-value">${recipe.nutrition.fat}g</div>
              <div class="nutrition-label">脂質</div>
            </div>
            <div class="nutrition-item">
              <div class="nutrition-value">${recipe.nutrition.fiber}g</div>
              <div class="nutrition-label">食物繊維</div>
            </div>
          </div>
        </div>
        
        <div class="instructions-section">
          <h4 class="instructions-title">
            <i class="fas fa-magic"></i> 作り方（超簡単！）
          </h4>
          <ol class="instructions-list">
            ${recipe.instructions.map(step => `<li>${step}</li>`).join('')}
          </ol>
        </div>
        
        ${recipe.mamaNote ? `
          <div style="background: var(--light-orange); padding: 1rem; border-radius: 8px; margin-top: 1rem; border-left: 4px solid var(--secondary-color);">
            <strong style="color: var(--secondary-color);">👩‍🍳 アドバイス：</strong><br>
            ${recipe.mamaNote}
          </div>
        ` : ''}
        
        <div class="recipe-tags">
          ${recipe.tags.map(tag => `<span class="recipe-tag">#${tag}</span>`).join('')}
        </div>
        
        <div style="text-align: center; margin-top: 1.5rem;">
          <button class="mama-button btn-primary" onclick="toggleFavorite(${recipe.id})">
            <i class="fas fa-heart"></i> ${isFavorited ? 'お気に入り登録済み' : 'お気に入りに追加'}
          </button>
        </div>
      </div>
    </div>
  `;
}

// Accordion toggle for recipe cards
function toggleRecipeDetails(event) {
  const header = event.currentTarget;
  const content = header.nextElementSibling;
  if (!content) return;
  const isOpen = content.style.display === 'block';
  content.style.display = isOpen ? 'none' : 'block';
  const arrow = header.querySelector('.accordion-arrow i');
  if (arrow) {
    if (isOpen) {
      arrow.classList.remove('fa-chevron-up');
      arrow.classList.add('fa-chevron-down');
    } else {
      arrow.classList.remove('fa-chevron-down');
      arrow.classList.add('fa-chevron-up');
    }
  }
}
// Accordion toggle for sections
function toggleSection(event) {
  const header = event.currentTarget;
  const content = header.nextElementSibling;
  if (!content) return;
  const isOpen = content.style.display === "block";
  content.style.display = isOpen ? "none" : "block";
  const arrow = header.querySelector(".accordion-arrow i");
  if (arrow) {
    if (isOpen) {
      arrow.classList.remove("fa-chevron-up");
      arrow.classList.add("fa-chevron-down");
    } else {
      arrow.classList.remove("fa-chevron-down");
      arrow.classList.add("fa-chevron-up");
    }
  }
}


// Get difficulty text in Japanese
function getDifficultyText(difficulty) {
  const difficultyMap = {
    'easy': '簡単',
    'medium': '普通',
    'hard': '本格的'
  };
  return difficultyMap[difficulty] || '普通';
}

// Toggle favorite status
function toggleFavorite(recipeId) {
  if (favorites.has(recipeId)) {
    favorites.delete(recipeId);
    showNotification('お気に入りから削除しました', 'info');
  } else {
    favorites.add(recipeId);
    showNotification('お気に入りに追加しました！', 'success');
  }
  saveFavorites();
  renderResults(); // Re-render to update button state
}

// Show notification
function showNotification(message, type = 'info') {
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed;
    top: 2rem;
    right: 2rem;
    background: ${type === 'success' ? 'var(--primary-color)' : type === 'warning' ? 'var(--secondary-color)' : 'var(--accent-color)'};
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 12px;
    font-weight: 600;
    z-index: 9999;
    box-shadow: var(--shadow-hover);
    transform: translateX(100%);
    transition: transform 0.3s ease;
  `;
  notification.textContent = message;
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.transform = 'translateX(0)';
  }, 100);
  
  setTimeout(() => {
    notification.style.transform = 'translateX(100%)';
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 300);
  }, 3000);
}

// Save favorites to localStorage
function saveFavorites() {
  try {
    localStorage.setItem('mama-favorites', JSON.stringify([...favorites]));
  } catch (e) {
    console.log('Cannot save favorites:', e);
  }
}

// Load favorites from localStorage
function loadFavorites() {
  try {
    const saved = localStorage.getItem('mama-favorites');
    if (saved) {
      favorites = new Set(JSON.parse(saved));
    }
  } catch (e) {
    console.log('Cannot load favorites:', e);
  }
}

// Update statistics
function updateStats() {
  selectedCountEl.textContent = selectedIngredients.size;
  recipeCountEl.textContent = currentRecipes.length;
  totalRecipeCountEl.textContent = mamaRecipesData.recipes.length;
  
  if (currentRecipes.length > 0) {
    const averageMatch = currentRecipes.reduce((sum, item) => sum + item.score, 0) / currentRecipes.length;
    matchRateEl.textContent = Math.round(averageMatch * 100) + '%';
    
    const averageTime = currentRecipes.reduce((sum, item) => sum + item.recipe.cookingTime, 0) / currentRecipes.length;
    avgTimeEl.textContent = Math.round(averageTime) + '分';
  } else {
    matchRateEl.textContent = '0%';
    avgTimeEl.textContent = '0分';
  }
}

// Event listeners
addBtn.addEventListener('click', addCustomIngredient);
searchBtn.addEventListener('click', searchRecipes);

// Allow Enter key to add custom ingredient
customInput.addEventListener('keypress', (e) => {
  if (e.key === 'Enter') {
    addCustomIngredient();
  }
});

// Keyboard shortcuts for busy moms
document.addEventListener('keydown', (e) => {
  if (e.ctrlKey || e.metaKey) {
    switch (e.key) {
      case 'Enter':
        e.preventDefault();
        searchRecipes();
        break;
      case 'k':
        e.preventDefault();
        customInput.focus();
        break;
    }
  }
});

// Initialize app when page loads
document.addEventListener('DOMContentLoaded', init);

// Demo mode: Auto-select common ingredients for busy moms
setTimeout(() => {
  const demoIngredients = ['卵', '玉ねぎ', '豚肉', 'じゃがいも'];
  demoIngredients.forEach(ingredient => {
    const checkbox = document.querySelector(`input[value="${ingredient}"]`);
    if (checkbox) {
      checkbox.checked = true;
      toggleIngredient(ingredient, true);
      checkbox.closest('.ingredient-card').classList.add('selected');
    }
  });
  
  showNotification('デモ用に食材を選択済みです！「AIにレシピを提案してもらう」をクリック♪', 'info');
}, 1000);

// PWA Service Worker registration
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js')
    .then(registration => console.log('SW registered:', registration))
    .catch(error => console.log('SW registration failed:', error));
}
</script>

</body>
</html>
